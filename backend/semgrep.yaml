# backend/semgrep.yaml
rules:
  - id: hardcoded-secrets
    pattern: |
      $X = "$SECRET"
    languages: [python]
    message: Possible hardcoded secret detected
    severity: ERROR
    paths:
      exclude:
        - tests/
        - migrations/
  
  - id: sql-injection
    pattern: |
      execute($QUERY + $VAR)
    languages: [python]
    message: Possible SQL injection vulnerability
    severity: ERROR
    paths:
      exclude:
        - tests/
        - migrations/
  
  - id: insecure-tempfile
    pattern: |
      tempfile.mktemp(...)
    languages: [python]
    message: Use of insecure temporary file creation
    severity: WARNING
    paths:
      exclude:
        - tests/
        - migrations/
